# Tiema Platform

Tiema is an industrial plugin platform that supports full-stack plugin development from PLC-level control to enterprise integration. This repository is the Tiema Full-Chain MVP implementation.

Recent changes (summary)
- Naming & terminology unified:
  - The component previously called "Backplane" has been fully renamed to **DataConnect** (protocol, generated stubs, service name, startup banners).
  - Runtime and SDK terms are unified to **Plugin / PluginInstanceId** (previously Module/ModuleInstanceId).
- Recommended project renames:
  - `Tiema.Backplane.Core` → `Tiema.DataConnect.Core`
  - `Tiema.BackplaneService` → `Tiema.DataConnect.Service` (standalone DataConnect host)
- Protobuf:
  - Service name: `DataConnect` (C# generated namespace: `Tiema.Connect.Grpc.V1`)
  - Tag types live in `tagsystem.proto` (C# namespace: `Tiema.Tags.Grpc.V1`)
  - Fields use plugin terminology (`PluginInstanceId`, `SourcePluginInstanceId`, etc.)

Overview (MVP)
- Plugins define domain data and behavior. Tiema DataConnect provides the connection/routing and the data plane (MVP implements RegisterTags / Publish / Subscribe / GetLastValue).
- Tiema.Runtime hosts plugin lifecycle, rack/slot orchestration, and the host-level service registry (`IServiceRegistry`).
- SDK (Tiema.Plugin.Sdk) provides `PluginBase`, `IPluginContext`, and helpers for plugin authors.
- Tests include InMemory backplane and gRPC DataConnect smoke tests (Register → Publish → Get → Subscribe).

What’s done
- Project skeleton, rack/slot support
- Tag system and subscription (InMemory + gRPC transport)
- Backplane → DataConnect rename across proto and generated code
- Plugin terminology unified (`IPlugin`, `IPluginContext`, `PluginBase`, etc.)
- Example plugins (ModbusSensor, TemperatureLogic, SimpleAlarm)
- CI job(s) updated to build DataConnect and run smoke tests

Quick start (MVP)
- Local debug: prefer the InMemory backplane
  - Set `messaging.transport` to `inmemory` in `tiema.config.json`
  - Run `Tiema.Runtime` to start the host and load plugins
- Run standalone DataConnect service:
  - Executable example: `Tiema.DataConnect.Service.exe` or run in a container
  - Env vars (legacy compatibility): `TIEMA_BACKPLANE_HOST` / `TIEMA_BACKPLANE_PORT`
    - Recommended new names: `TIEMA_DATACONNECT_HOST` / `TIEMA_DATACONNECT_PORT`

Build & development
- Target framework: .NET 10
- Protobuf stubs are generated by the projects' MSBuild / proto configuration (see `Tiema.Protocols`).
- Common commands:
  - Build: `dotnet build`
  - Test: `dotnet test`
  - Run DataConnect service: start `Tiema.DataConnect.Service` project
  - Run host: start `Tiema.Runtime` project

Notes & migration hints
- This is an MVP. We performed an immediate, global rename (no compatibility shims) to simplify future work. Production features (clustering, persistence, auth) will be added incrementally.
- If you see missing generated types (e.g. `DataConnect.BindService`, `Tiema.Tags.Grpc.V1`), clean `bin/obj` and rebuild to force proto regeneration.
- Plugin authors: do not rely on tag handles being available inside `Initialize`. Use `OnStart` or let the host’s `TagAutoRegistrar` perform registration and wiring after initialization.

Contributing & support
- Welcome Issues and PRs. Work on branch `feat/tiema-backplane-mvp` and keep small, CI-green commits.
- Contact: open a GitHub Issue or email 896294580@qq.com

License
- MIT License